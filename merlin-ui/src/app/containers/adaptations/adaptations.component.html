<mat-toolbar color="primary">
  <span>Adaptations</span>

  <div class="mat-toolbar-right">
    <button mat-icon-button [matMenuTriggerFor]="menu">
      <mat-icon>more_vert</mat-icon>
    </button>

    <mat-menu #menu="matMenu">
      <button mat-menu-item [matMenuTriggerFor]="views">
        <mat-icon>library_books</mat-icon>
        <span>Views</span>
      </button>
      <button mat-menu-item (click)="onAbout()">
        <mat-icon>info</mat-icon>
        <span>About</span>
      </button>
    </mat-menu>

    <mat-menu #views="matMenu">
      <button mat-menu-item [routerLink]="['/plans']">Plans</button>
    </mat-menu>
  </div>
</mat-toolbar>

<mat-progress-bar
  *ngIf="loading"
  color="accent"
  mode="indeterminate"
></mat-progress-bar>

<as-split [gutterSize]="4">
  <as-split-area [size]="25">
    <app-panel-header>
      Create Adaptation
    </app-panel-header>
    <div class="p-1">
      <form [formGroup]="createAdaptationForm" (ngSubmit)="onSubmit()">
        <mat-form-field class="w-100" appearance="fill">
          <mat-label>Name</mat-label>
          <input
            [required]="true"
            autocomplete="off"
            formControlName="name"
            id="create-adaptation-form-name"
            matInput
            type="text"
          />
        </mat-form-field>

        <mat-form-field class="w-100" appearance="fill">
          <mat-label>Version</mat-label>
          <input
            [required]="true"
            autocomplete="off"
            formControlName="version"
            id="create-adaptation-form-version"
            matInput
            type="text"
          />
        </mat-form-field>

        <mat-form-field class="w-100" appearance="fill">
          <mat-label>Mission</mat-label>
          <input
            [required]="true"
            autocomplete="off"
            formControlName="mission"
            id="create-adaptation-form-mission"
            matInput
            type="text"
          />
        </mat-form-field>

        <mat-form-field class="w-100" appearance="fill">
          <mat-label>Owner</mat-label>
          <input
            [required]="true"
            autocomplete="off"
            formControlName="owner"
            id="create-adaptation-form-owner"
            matInput
            type="text"
          />
        </mat-form-field>

        <div class="pb-4">
          <input
            [required]="true"
            id="create-adaptation-form-file"
            type="file"
            (change)="onFileChange($event)"
          />
        </div>

        <button
          [disabled]="!createAdaptationForm.valid"
          class="mr-2"
          color="accent"
          id="create-adaptation-form-create-button"
          mat-raised-button
        >
          Create
        </button>
      </form>
    </div>
  </as-split-area>

  <as-split-area [size]="75">
    <app-panel-header>
      Adaptation List
    </app-panel-header>
    <div class="p-1">
      <mat-card *ngIf="!adaptations.length" id="no-adaptations-message">
        No adaptations found.
      </mat-card>

      <table
        *ngIf="adaptations.length"
        [dataSource]="adaptations"
        class="w-100 mat-elevation-z1"
        id="adaptations-table"
        mat-table
      >
        <ng-container matColumnDef="menu">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let element">
            <button
              mat-icon-button
              [id]="'adaptation-menu-' + element.name"
              [matMenuTriggerFor]="adaptationMenu"
            >
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #adaptationMenu="matMenu">
              <button
                mat-menu-item
                [id]="'adaptation-menu-delete-' + element.name"
                (click)="onDeleteAdaptation(element.id)"
              >
                <span>
                  Delete
                </span>
              </button>
            </mat-menu>
          </td>
        </ng-container>

        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef>Id</th>
          <td mat-cell *matCellDef="let element">
            {{ element.id }}
          </td>
        </ng-container>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let element">
            {{ element.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="version">
          <th mat-header-cell *matHeaderCellDef>Version</th>
          <td mat-cell *matCellDef="let element">
            {{ element.version }}
          </td>
        </ng-container>

        <ng-container matColumnDef="mission">
          <th mat-header-cell *matHeaderCellDef>Mission</th>
          <td mat-cell *matCellDef="let element">
            {{ element.mission }}
          </td>
        </ng-container>

        <ng-container matColumnDef="owner">
          <th mat-header-cell *matHeaderCellDef>Owner</th>
          <td mat-cell *matCellDef="let element">
            {{ element.owner }}
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>
  </as-split-area>
</as-split>
