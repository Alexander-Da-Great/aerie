<mat-toolbar color="primary">
  <span>Adaptations</span>
</mat-toolbar>

<as-split [gutterSize]="4">
  <as-split-area [size]="35">
    <app-panel-header>
      Create Adaptation
    </app-panel-header>
    <div class="p-1">
      <mat-card>
        <form [formGroup]="createAdaptationForm" (ngSubmit)="onSubmit()">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Name</mat-label>
            <input
              [required]="true"
              autocomplete="off"
              formControlName="name"
              id="create-adaptation-form-name"
              matInput
              type="text"
            />
            <mat-error *ngIf="createAdaptationForm.controls.name.invalid">
              You must enter a name
            </mat-error>
          </mat-form-field>

          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Version</mat-label>
            <input
              [required]="true"
              autocomplete="off"
              formControlName="version"
              id="create-adaptation-form-version"
              matInput
              type="text"
            />
            <mat-error *ngIf="createAdaptationForm.controls.version.invalid">
              You must enter a version
            </mat-error>
          </mat-form-field>

          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Mission</mat-label>
            <input
              [required]="true"
              autocomplete="off"
              formControlName="mission"
              id="create-adaptation-form-mission"
              matInput
              type="text"
            />
            <mat-error *ngIf="createAdaptationForm.controls.mission.invalid">
              You must enter a mission
            </mat-error>
          </mat-form-field>

          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Owner</mat-label>
            <input
              [required]="true"
              autocomplete="off"
              formControlName="owner"
              id="create-adaptation-form-owner"
              matInput
              type="text"
            />
            <mat-error *ngIf="createAdaptationForm.controls.owner.invalid">
              You must enter an owner
            </mat-error>
          </mat-form-field>

          <div class="pb-4">
            <input
              [required]="true"
              id="create-adaptation-form-file"
              type="file"
              (change)="onFileChange($event)"
            />
          </div>

          <button
            [disabled]="!createAdaptationForm.valid"
            class="mr-2"
            color="accent"
            id="create-adaptation-form-create-button"
            mat-raised-button
          >
            Create
          </button>
        </form>
      </mat-card>
    </div>
  </as-split-area>

  <as-split-area [size]="65">
    <app-panel-header>
      Adaptation List
    </app-panel-header>
    <div class="p-1">
      <app-placeholder *ngIf="adaptations === null"></app-placeholder>
      <ng-container *ngIf="adaptations !== null">
        <mat-card *ngIf="!adaptations.length" id="no-adaptations-message">
          No adaptations found.
        </mat-card>

        <table
          *ngIf="adaptations.length"
          [dataSource]="adaptations"
          class="w-100 mat-elevation-z1"
          id="adaptations-table"
          mat-table
        >
          <ng-container matColumnDef="menu">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element">
              <button
                mat-icon-button
                [id]="'adaptation-menu-' + element.name"
                [matMenuTriggerFor]="adaptationMenu"
              >
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #adaptationMenu="matMenu">
                <button
                  mat-menu-item
                  [id]="'adaptation-menu-create-plan-' + element.name"
                  (click)="onCreatePlan(element.id)"
                >
                  <span>
                    Create Plan
                  </span>
                </button>
                <button
                  mat-menu-item
                  [id]="'adaptation-menu-delete-' + element.name"
                  (click)="onDeleteAdaptation(element.id)"
                >
                  <span>
                    Delete
                  </span>
                </button>
              </mat-menu>
            </td>
          </ng-container>

          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef>Id</th>
            <td mat-cell *matCellDef="let element">
              {{ element.id }}
            </td>
          </ng-container>

          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let element">
              {{ element.name }}
            </td>
          </ng-container>

          <ng-container matColumnDef="version">
            <th mat-header-cell *matHeaderCellDef>Version</th>
            <td mat-cell *matCellDef="let element">
              {{ element.version }}
            </td>
          </ng-container>

          <ng-container matColumnDef="mission">
            <th mat-header-cell *matHeaderCellDef>Mission</th>
            <td mat-cell *matCellDef="let element">
              {{ element.mission }}
            </td>
          </ng-container>

          <ng-container matColumnDef="owner">
            <th mat-header-cell *matHeaderCellDef>Owner</th>
            <td mat-cell *matCellDef="let element">
              {{ element.owner }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </ng-container>
    </div>
  </as-split-area>
</as-split>
